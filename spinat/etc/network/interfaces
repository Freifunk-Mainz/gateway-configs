# This file describes the network interfaces available on your system
# and how to activate them. For more information, see interfaces(5).

# The loopback network interface
auto lo
iface lo inet loopback

# The primary network interface
auto eth0
iface eth0 inet dhcp

auto mainzBR
iface mainzBR inet static
	bridge-ports none
	address 10.37.0.7
	netmask 255.255.192.0
	post-up		/sbin/ip rule add iif $IFACE table 37 
	pre-down	/sbin/ip rule del iif $IFACE table 37

iface mainzBR inet6 static
	address fd37:b4dc:4b1e::0a25:0007
	netmask 64

auto wiesbadenBR
iface wiesbadenBR inet static
        bridge-ports none
        address 10.56.0.7
        netmask 255.255.192.0
        post-up         /sbin/ip rule add iif $IFACE table 56
        pre-down        /sbin/ip rule del iif $IFACE table 56

iface wiesbadenBR inet6 static
        address fd56:b4dc:4b1e::0a38:0007
        netmask 64


allow-hotplug mainzVPN
iface mainzVPN inet6 manual
	pre-up		/sbin/modprobe batman_adv
        pre-up		/sbin/ip link set address 02:00:0a:25:00:07 dev $IFACE 
        post-up		/usr/sbin/batctl -m mainzBAT if add $IFACE 
        post-up		/sbin/ip link set dev mainzBAT up

allow-hotplug wiesbadenVPN
iface wiesbadenVPN inet6 manual
	pre-up		/sbin/modprobe batman_adv
        pre-up		/sbin/ip link set address 02:00:0a:38:00:07 dev $IFACE
        post-up		/usr/sbin/batctl -m wiesbadenBAT if add $IFACE
        post-up		/sbin/ip link set dev wiesadenBAT up

allow-hotplug mainzBAT
iface mainzBAT inet6 manual
	pre-up		/sbin/modprobe batman-adv
	post-up		/sbin/brctl addif mainzBR $IFACE
	post-up 	/usr/sbin/batctl -m $IFACE it 10000
	post-up 	/usr/sbin/batctl -m $IFACE vm server
	post-up 	/usr/sbin/batctl -m $IFACE gw server 3200KBit/250KBit
#	post-up		/sbin/ip rule add from all fwmark 0x1 table 37
#
	pre-down	/sbin/brctl delif mainzBR $IFACE || true

allow-hotplug wiesbadenBAT
iface wiesbadenBAT inet6 manual
        pre-up          /sbin/modprobe batman-adv
        post-up         /sbin/brctl addif wiesbadenBR $IFACE
	post-up 	/usr/sbin/batctl -m $IFACE it 10000
	post-up 	/usr/sbin/batctl -m $IFACE vm server
	post-up 	/usr/sbin/batctl -m $IFACE gw server 3200KBit/250KBit
#       post-up         /sbin/ip rule add from all fwmark 0x1 table 56
#
        pre-down        /sbin/brctl delif wiesbadenBR $IFACE || true
